<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Mapa Comercio Local Sevilla</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=DM+Sans:wght@500;700&display=swap" rel="stylesheet">

  <!-- Leaflet -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    crossorigin=""
  />

  <!-- MarkerCluster CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"
  />
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"
  />

  <style>
    :root {
      --color-bg: #f5f5f7;
      --color-panel: #ffffff;
      --color-primary: #2563eb;
      --color-primary-soft: rgba(37,99,235,0.1);
      --color-accent: #f97316;
      --color-text: #111827;
      --color-muted: #6b7280;
      --radius-md: 10px;
      --radius-lg: 14px;
      --shadow-soft: 0 18px 30px rgba(15,23,42,0.16);
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--color-text);
      background: radial-gradient(circle at top left, #e0f2fe 0, #f9fafb 45%, #f5f5f7 100%);
    }

    #map {
      position: absolute;
      top: 64px;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 1;
    }

    /* Header superior */
    .app-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 64px;
      padding: 12px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      backdrop-filter: blur(10px);
      background: linear-gradient(to right, rgba(255,255,255,0.9), rgba(248,250,252,0.9));
      border-bottom: 1px solid rgba(148,163,184,0.25);
      z-index: 1500;
    }

    .app-brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .app-logo {
      width: 32px;
      height: 32px;
      border-radius: 10px;
      background: radial-gradient(circle at 30% 30%, #f97316, #2563eb);
      box-shadow: 0 10px 20px rgba(15,23,42,0.2);
    }

    .app-title {
      display: flex;
      flex-direction: column;
    }

    .app-title h1 {
      margin: 0;
      font-family: "DM Sans", system-ui, sans-serif;
      font-size: 18px;
      letter-spacing: 0.01em;
    }

    .app-title span {
      font-size: 12px;
      color: var(--color-muted);
    }

    .app-header-right {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--color-muted);
    }

    /* Botones flotantes */
    #btnToggleBusqueda,
    #btnToggleFiltros {
      position: absolute;
      top: 76px;
      z-index: 1100;
      background: var(--color-panel);
      border-radius: 999px;
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 10px 20px rgba(15,23,42,0.18);
      cursor: pointer;
      font-size: 13px;
      color: var(--color-text);
      border: 1px solid rgba(148,163,184,0.4);
    }

    #btnToggleBusqueda span.icon,
    #btnToggleFiltros span.icon {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      background: var(--color-primary-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-primary);
    }

    #btnToggleBusqueda {
      left: 14px;
    }

    #btnToggleFiltros {
      right: 14px;
    }

    #btnRecentraMi {
      position: absolute;
      bottom: 90px;
      right: 14px;
      z-index: 1100;
      background: var(--color-panel);
      border-radius: 999px;
      padding: 6px 10px;
      box-shadow: 0 10px 20px rgba(15,23,42,0.2);
      cursor: pointer;
      font-size: 12px;
      display: none;
      border: 1px solid rgba(148,163,184,0.4);
      color: var(--color-text);
    }

    /* Panel b√∫squeda r√°pida */
    .panel-busqueda {
      position: absolute;
      top: 120px;
      left: 14px;
      background: var(--color-panel);
      padding: 10px 12px 12px;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      z-index: 1000;
      max-width: 260px;
      font-size: 13px;
      border: 1px solid rgba(148,163,184,0.25);
    }

    .panel-busqueda h2 {
      margin: 0 0 6px 0;
      font-size: 15px;
      font-weight: 600;
    }

    .field-label {
      font-size: 11px;
      font-weight: 500;
      color: var(--color-muted);
      margin-top: 6px;
      margin-bottom: 3px;
    }

    .panel-busqueda input[type="text"],
    .panel-busqueda select {
      width: 100%;
      box-sizing: border-box;
      margin-bottom: 4px;
      padding: 6px 8px;
      font-size: 13px;
      border-radius: 8px;
      border: 1px solid rgba(148,163,184,0.7);
      outline: none;
    }

    .panel-busqueda input:focus,
    .panel-busqueda select:focus {
      border-color: var(--color-primary);
      box-shadow: 0 0 0 1px rgba(37,99,235,0.25);
    }

    .panel-busqueda button {
      padding: 6px 8px;
      font-size: 13px;
      cursor: pointer;
      border-radius: 999px;
      border: none;
    }

    .btn-primary {
      background: var(--color-primary);
      color: #fff;
    }

    .btn-ghost {
      background: rgba(15,23,42,0.03);
      color: var(--color-text);
    }

    /* Panel filtros */
    .panel-filtros {
      position: absolute;
      top: 120px;
      right: 14px;
      width: 300px;
      background: var(--color-panel);
      padding: 10px 12px 12px;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      z-index: 1000;
      font-size: 13px;
      border: 1px solid rgba(148,163,184,0.25);
    }

    .panel-filtros h3 {
      margin: 0 0 6px 0;
      font-size: 14px;
      font-weight: 600;
    }

    .panel-section-title {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--color-muted);
      margin-top: 6px;
      margin-bottom: 4px;
    }

    .panel-filtros select,
    .panel-filtros input[type="text"] {
      width: 100%;
      box-sizing: border-box;
      padding: 5px 7px;
      font-size: 13px;
      border-radius: 8px;
      border: 1px solid rgba(148,163,184,0.7);
      outline: none;
    }

    .panel-filtros select:focus,
    .panel-filtros input[type="text"]:focus {
      border-color: var(--color-primary);
      box-shadow: 0 0 0 1px rgba(37,99,235,0.25);
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }

    .chip-filter {
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(148,163,184,0.12);
      color: var(--color-muted);
    }

    .checkbox-linea {
      margin-top: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: var(--color-muted);
    }

    .checkbox-linea input {
      accent-color: var(--color-primary);
    }

    .panel-filtros .fila-botones {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }

    .panel-filtros button {
      flex: 1;
      padding: 6px 8px;
      font-size: 13px;
      cursor: pointer;
      border-radius: 999px;
      border: none;
    }

    .panel-filtros .btn-apply {
      background: var(--color-primary);
      color: #fff;
    }

    .panel-filtros .btn-reset {
      background: rgba(15,23,42,0.03);
      color: var(--color-text);
    }

    #contadorResultados {
      margin-top: 6px;
      font-size: 11px;
      color: var(--color-muted);
    }

    /* Leyenda */
    #leyendaCategorias {
      position: absolute;
      bottom: 12px;
      left: 14px;
      z-index: 900;
      background: var(--color-panel);
      padding: 6px 8px;
      border-radius: 10px;
      box-shadow: 0 10px 20px rgba(15,23,42,0.18);
      font-size: 11px;
      max-width: 260px;
      border: 1px solid rgba(148,163,184,0.25);
    }

    /* Panel detalle */
    #panelDetalle {
      position: absolute;
      top: 64px;
      right: 0;
      width: 360px;
      max-width: 100%;
      height: calc(100% - 64px);
      background: linear-gradient(to bottom, #f9fafb, #ffffff);
      box-shadow: -18px 0 35px rgba(15,23,42,0.25);
      z-index: 1200;
      transform: translateX(100%);
      transition: transform 0.25s ease-out;
      display: flex;
      flex-direction: column;
      font-size: 13px;
      border-radius: 16px 0 0 0;
    }

    #panelDetalle.abierto {
      transform: translateX(0);
    }

    #panelDetalleHeader {
      padding: 10px 14px;
      border-bottom: 1px solid rgba(148,163,184,0.3);
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(8px);
    }

    #panelDetalle h2 {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
    }

    #panelDetalleBody {
      padding: 10px 14px 14px;
      overflow-y: auto;
      flex: 1;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(148,163,184,0.12);
      font-size: 11px;
      color: var(--color-muted);
      margin-right: 4px;
    }

    .btn-favorito {
      border: none;
      background: none;
      cursor: pointer;
      font-size: 18px;
      margin-right: 6px;
    }

    .btn-favorito.activo {
      color: #e11d48;
    }

    #btnCerrarDetalle {
      border: none;
      background: rgba(15,23,42,0.04);
      border-radius: 999px;
      width: 26px;
      height: 26px;
      cursor: pointer;
      font-size: 14px;
    }

    a {
      color: var(--color-primary);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }

    @media (max-width: 768px) {
      #map {
        top: 64px;
      }
      .panel-busqueda {
        max-width: 90%;
        left: 5%;
      }
      .panel-filtros {
        width: 92%;
        right: 4%;
        top: 118px;
        max-height: 60%;
        overflow-y: auto;
      }
      #panelDetalle {
        width: 100%;
        border-radius: 16px 16px 0 0;
      }
    }
  </style>
</head>
<body>
<div class="app-header">
  <div class="app-brand">
    <div class="app-logo"></div>
    <div class="app-title">
      <h1>Comercio Local Sevilla</h1>
      <span>Explora negocios de barrio en tu ciudad</span>
    </div>
  </div>
  <div class="app-header-right">
    <span>Beta</span>
  </div>
</div>

<div id="map"></div>

<!-- Botones flotantes -->
<div id="btnToggleBusqueda">
  <span class="icon">üîé</span><span>Buscar</span>
</div>
<div id="btnToggleFiltros">
  <span class="icon">‚öôÔ∏è</span><span>Filtros</span>
</div>
<div id="btnRecentraMi">Recentrar en m√≠</div>

<!-- Panel b√∫squeda r√°pida -->
<div class="panel-busqueda" id="panelBusqueda" style="display:none;">
  <h2>¬øQu√© buscas hoy?</h2>

  <div class="field-label">Qu√©</div>
  <input id="fTextoLibre" type="text" placeholder="Ej: bar, panader√≠a, ropa, gimnasio" />

  <div class="field-label">D√≥nde</div>
  <input id="fUbicacionCliente" type="text" placeholder="Direcci√≥n o barrio" />

  <div class="field-label">Radio</div>
  <select id="fRadioDistancia">
    <option value="">Sin l√≠mite</option>
    <option value="500">500 m</option>
    <option value="1000">1 km</option>
    <option value="2000">2 km</option>
    <option value="3000">3 km</option>
  </select>

  <div style="margin-top:6px; display:flex; gap:6px;">
    <button id="btnBuscarRapido" class="btn-primary">Buscar</button>
    <button id="btnCercaDeMi" class="btn-ghost">Cerca de m√≠</button>
  </div>
</div>

<!-- Panel filtros -->
<div class="panel-filtros" id="panelFiltros" style="display:none;">
  <h3>Filtros avanzados</h3>

  <div class="panel-section-title">Qu√©</div>
  <label class="field-label" for="fCategoria">Categor√≠a principal</label>
  <select id="fCategoria">
    <option value="">Todas</option>
    <option value="Comida">Comida</option>
    <option value="Cafeter√≠a">Cafeter√≠a</option>
    <option value="Alimentaci√≥n">Alimentaci√≥n</option>
    <option value="Moda">Moda</option>
    <option value="Belleza">Belleza</option>
    <option value="Salud">Salud</option>
    <option value="Ocio">Ocio</option>
    <option value="Deportes">Deportes</option>
    <option value="Servicios">Servicios</option>
    <option value="Otros">Otros</option>
  </select>

  <label class="field-label" for="fTipoDetalle">Tipo dentro de la categor√≠a</label>
  <select id="fTipoDetalle">
    <option value="">Todos los tipos</option>
  </select>

  <div class="panel-section-title">Precio y valoraci√≥n</div>
  <div style="display:flex; gap:6px;">
    <div style="flex:1;">
      <label class="field-label" for="fPrecioMin">Precio m√≠n.</label>
      <select id="fPrecioMin">
        <option value="1">1 ‚òÖ</option>
        <option value="2" selected>2 ‚òÖ</option>
        <option value="3">3 ‚òÖ</option>
      </select>
    </div>
    <div style="flex:1;">
      <label class="field-label" for="fPrecioMax">Precio m√°x.</label>
      <select id="fPrecioMax">
        <option value="1">1 ‚òÖ</option>
        <option value="2">2 ‚òÖ</option>
        <option value="3" selected>3 ‚òÖ</option>
      </select>
    </div>
  </div>

  <label class="field-label" for="fOrden">Ordenar por</label>
  <select id="fOrden">
    <option value="ninguno">Sin orden especial</option>
    <option value="valoracion_desc">Mejor valorados primero</option>
  </select>

  <div class="panel-section-title">D√≥nde</div>
  <label class="field-label" for="fBarrio">Barrio</label>
  <select id="fBarrio"></select>

  <div class="panel-section-title">Estado</div>
  <div class="checkbox-linea">
    <input type="checkbox" id="fSoloAbiertos" />
    <label for="fSoloAbiertos">Solo abiertos ahora</label>
  </div>
  <div class="checkbox-linea">
    <input type="checkbox" id="fSoloEnMapa" />
    <label for="fSoloEnMapa">Solo locales en la vista actual</label>
  </div>

  <div class="panel-section-title">Resumen</div>
  <div class="chip-row" id="chipsResumen">
    <!-- se puede rellenar m√°s adelante si quieres mostrar chips din√°micos -->
    <span class="chip-filter">Filtros guardados entre sesiones</span>
  </div>

  <div class="fila-botones">
    <button id="btnAplicarFiltros" class="btn-apply">Aplicar filtros</button>
    <button id="btnQuitarFiltros" class="btn-reset">Quitar</button>
  </div>

  <div id="contadorResultados">Mostrando todos los locales</div>
</div>

<!-- Leyenda -->
<div id="leyendaCategorias">
  <b>Categor√≠as</b><br />
  <span style="color:#d7191c;">‚óè</span> Comida
  <span style="color:#fdae61; margin-left:6px;">‚óè</span> Cafeter√≠a
  <span style="color:#1a9641; margin-left:6px;">‚óè</span> Alimentaci√≥n<br />
  <span style="color:#7b3294;">‚óè</span> Moda
  <span style="color:#4575b4; margin-left:6px;">‚óè</span> Belleza
  <span style="color:#ffff00; margin-left:6px;">‚óè</span> Salud<br />
  <span style="color:#313695;">‚óè</span> Ocio
  <span style="color:#f46d43; margin-left:6px;">‚óè</span> Deportes
  <span style="color:#4d4d4d; margin-left:6px;">‚óè</span> Servicios
</div>

<!-- Panel detalle -->
<div id="panelDetalle">
  <div id="panelDetalleHeader">
    <h2 id="detalleNombre">Local</h2>
    <div style="display:flex; align-items:center;">
      <button id="btnFavorito" class="btn-favorito" title="Marcar como favorito">‚ô°</button>
      <button id="btnCerrarDetalle">‚úï</button>
    </div>
  </div>
  <div id="panelDetalleBody"></div>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
<!-- MarkerCluster JS -->
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
<script src="script.js"></script>
</body>
</html>
